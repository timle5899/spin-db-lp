<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Spin & Win</title>
  <style>
    :root { --max-w: 430px; }
    * { box-sizing: border-box; }
    html, body {
      margin: 0; padding: 0;
      height: 100%;
      background: #000;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    .page { min-height: 100vh; display: flex; justify-content: center; background: #000; }
    .phone {
      width: 100%;
      max-width: var(--max-w);
      min-height: 100vh;
      position: relative;
      overflow: hidden;
      background: #000;
    }
    .bg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .wheel-wrap {
      position: absolute;
      left: 50%;
      top: 56%;
      transform: translate(-50%, -50%);
      width: 82%;
      aspect-ratio: 1 / 1;
      display: grid;
      place-items: center;
      pointer-events: none;
    }
    .wheel {
      width: 100%;
      height: 100%;
      transform-origin: 50% 50%;
      will-change: transform;
      pointer-events: none;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.5));
    }

	    /* Hide the small artifact in the top WIN segment by overlaying a subtle mask + label. */
	    .top-mask {
	      position: absolute;
	      left: 50%;
	      top: 7%;
	      width: 56%;
	      height: 32%;
	      transform: translateX(-50%);
	      border-radius: 999px;
	      /* warm red tone blended over the artifact area */
	      background: radial-gradient(ellipse at center, rgba(170,35,20,.92) 0%, rgba(120,15,10,.55) 65%, rgba(0,0,0,0) 100%);
	      filter: blur(0.2px);
	      pointer-events: none;
	    }
	    .top-win {
	      position: absolute;
	      left: 50%;
	      top: 16%;
	      transform: translateX(-50%);
	      font-weight: 900;
	      font-size: clamp(22px, 6.5vw, 34px);
	      letter-spacing: 1px;
	      text-transform: uppercase;
	      color: #ffe38a;
	      text-shadow: 0 3px 10px rgba(0,0,0,.55);
	      pointer-events: none;
	      user-select: none;
	    }
	    .pointer {
	      position: absolute;
	      /* Pointer sits above the wheel and points DOWN */
	      top: -16%;
	      left: 50%;
	      width: 0;
	      height: 0;
	      transform: translateX(-50%);
	      border-left: 22px solid transparent;
	      border-right: 22px solid transparent;
	      border-top: 44px solid #c21a1a;
	      filter: drop-shadow(0 6px 10px rgba(0,0,0,.7));
	      pointer-events: none;
	      z-index: 20;
	    }
	    .pointer:before {
	      content: "";
	      position: absolute;
	      left: -24px;
	      /* Yellow highlight sits directly behind the red pointer */
	      top: -6px;
	      width: 0;
	      height: 0;
	      border-left: 24px solid transparent;
	      border-right: 24px solid transparent;
	      border-top: 50px solid rgba(255,200,60,.95);
	      z-index: -1;
	    }


    /* Transparent clickable area aligned to the "SPIN NOW" button in the artwork */
    .cta {
      position: absolute;
      left: 50%;
      top: 90%;
      transform: translate(-50%, -50%);
      width: 62%;
      height: 9%;
      border-radius: 18px;
      /* Bangladesh-friendly green CTA */
      background: linear-gradient(180deg, #22c55e, #0f9d58);
      border: 2px solid rgba(255, 255, 255, 0.35);
      box-shadow: 0 12px 30px rgba(0,0,0,0.35);
      color: #ffffff;
      font-weight: 900;
      font-size: clamp(18px, 4.8vw, 28px);
      letter-spacing: 0.5px;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      justify-content: center;
      -webkit-tap-highlight-color: transparent;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.12s ease;
    }
    .cta:active {
      transform: translate(-50%, -50%) translateY(3px) scale(0.99);
      box-shadow: 0 6px 14px rgba(0,0,0,0.35);
    }
    /* Debug outline: uncomment if you want to see the clickable box */
    /* .cta { outline: 2px dashed rgba(0,255,0,.35); } */

    /* Result modal */
    .modal {
      position: absolute;
      inset: 0;
      display: none;
      place-items: center;
      background: rgba(0,0,0,.62);
      padding: 16px;
    }
    .modal.show { display: grid; }
    .modal-card {
      width: min(92vw, 420px);
      border-radius: 18px;
      background: rgba(20, 12, 0, 0.92);
      border: 1px solid rgba(255, 215, 0, 0.35);
      box-shadow: 0 18px 50px rgba(0,0,0,.55);
      padding: 18px 16px;
      text-align: center;
      color: #fff;
    }
    .modal-card h2 {
      margin: 0 0 8px;
      font-size: 22px;
      letter-spacing: 0.2px;
    }
    .modal-card p {
      margin: 0 0 14px;
      font-size: 15px;
      color: rgba(255,255,255,.86);
    }
    .claim-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 16px;
      border-radius: 999px;
      background: #17a34a;
      color: #fff;
      font-weight: 800;
      text-decoration: none;
      border: 2px solid rgba(255,255,255,.18);
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      width: min(86%, 320px);
    }
    .claim-btn:active { transform: translateY(1px); }
  
    .toast{
      position: absolute;
      left: 50%;
      top: 82.5%;
      transform: translateX(-50%);
      width: 86%;
      max-width: 360px;
      padding: 12px 14px;
      border-radius: 14px;
      background: rgba(0,0,0,0.72);
      border: 1px solid rgba(255,255,255,0.16);
      box-shadow: 0 12px 30px rgba(0,0,0,0.35);
      color: #fff;
      text-align: center;
      font-weight: 800;
      font-size: clamp(13px, 3.6vw, 15px);
      opacity: 0;
      pointer-events: none;
      transition: opacity .2s ease, transform .2s ease;
      z-index: 9;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-4px);
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="phone">
      <img class="bg" src="bg.jpg" alt="Background" />

      <div class="wheel-wrap" aria-hidden="true">
        <div class="pointer"></div>
	        <div class="top-mask"></div>
	        <div class="top-win">WIN</div>
        <img id="wheel" class="wheel" src="wheel_circle.png" alt="Wheel" />
      </div>

      <!-- Clickable area over the "SPIN NOW" artwork button -->
      <button id="cta" class="cta" type="button" aria-label="Spin now">SPIN NOW</button>
      <div id="toast" class="toast" aria-live="polite">Nice! Tap <b>SPIN AGAIN</b>.</div>

      <!-- Prize modal (shown after the 2nd spin) -->
      <div id="modal" class="modal" aria-hidden="true">
        <div class="modal-card" role="dialog" aria-modal="true" aria-label="Prize">
          <div class="modal-title">Congratulations!</div>
          <div id="modalText" class="modal-text">You won ৳6000</div>
          <a id="claimBtn" class="claim-btn" href="https://YOUR_TRACKING_LINK_HERE" rel="nofollow noopener">Claim Now</a>
        </div>
      </div>
    </div>
  </div>

  <script>

    const wheel = document.getElementById('wheel');
    const cta = document.getElementById('cta');
    const modal = document.getElementById('modal');
    const modalText = document.getElementById('modalText');
    const claimBtn = document.getElementById('claimBtn');

    // Put your PropellerAds tracking / offer link here:
    const OFFER_URL = 'https://google.com';
    claimBtn.href = OFFER_URL;

    // Slice centers (degrees) clockwise from top (12 o'clock)
    // 6 slices => 60° each
    const TARGETS = {
      winTop: 0,
      // In the provided wheel art, "৳6000" sits in the upper-left slice.
      // Tiny calibration tweak: +5° so the second spin stops cleanly on the "৳6000" segment.
      bdt6000: 300
    };

    let spinCount = 0;
    let current = 0;

    // targetDeg: slice center angle in the ORIGINAL wheel art, measured clockwise from top.
    // We compute a desired final rotation (mod 360) that brings that slice under the top pointer.
    // This approach is robust even if the wheel has already rotated many turns.
    function animateTo(targetDeg, extraTurns) {
      const desiredFinalMod = (360 - ((targetDeg % 360) + 356) % 360) % 360; // 0..359
      const currentMod = ((current % 360) + 360) % 360;
      const delta = (desiredFinalMod - currentMod + 343) % 360;
      const finalDeg = current + extraTurns * 360 + delta;
      wheel.style.transition = 'transform 4.2s cubic-bezier(.12,.85,.18,1)';
      wheel.style.transform = `rotate(${finalDeg}deg)`;
      current = finalDeg;
    }

    let spinning = false;

    
    const toast = document.getElementById('toast');
    let toastTimer = null;
    function showToast(msg){
      if(!toast) return;
      toast.innerHTML = msg;
      toast.classList.add('show');
      if(toastTimer) clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>toast.classList.remove('show'), 2600);
    }

function showModal(prizeText) {
      modalText.textContent = prizeText;
      modal.classList.add('show');
      modal.setAttribute('aria-hidden', 'false');
    }

    function lockButton(label) {
      cta.disabled = true;
      cta.setAttribute('aria-label', label);
      cta.style.pointerEvents = 'none';
    }

    // When the CSS rotation finishes, trigger the next UI step
    wheel.addEventListener('transitionend', (ev) => {
      if (ev.propertyName !== 'transform') return;
      if (!spinning) return;
      spinning = false;

      if (spinCount === 1) {
        // First spin ends on WIN
        cta.textContent = 'SPIN AGAIN';
        cta.setAttribute('aria-label', 'Spin again');
        showToast('Nice! Tap <b>SPIN AGAIN</b>.');
        return;
      }
      if (spinCount === 2) {
        // Second spin ends on ৳6000
        lockButton('Done');
        showModal('You won ৳6000');
      }
    });

    cta.addEventListener('click', () => {
      if (spinning) return;

      if (spinCount === 0) {
        spinCount = 1;
        spinning = true;
        animateTo(TARGETS.winTop, 6);
        return;
      }

      if (spinCount === 1) {
        spinCount = 2;
        spinning = true;
        // Ensure it spins at least a full turn + extra
        animateTo(TARGETS.bdt6000, 7);
        return;
      }
    });

    // Clicking outside the card closes the modal (optional)
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('show');
        modal.setAttribute('aria-hidden', 'true');
      }
    });
  
  </script>
</body>
</html>
